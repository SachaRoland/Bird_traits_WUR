#### PCA FOR WITH PELICANS

# Make our objects 
# no ratios (width/length) included
birds_beak <- birds %>% 
  dplyr::select(1,9, 10, 11, 12)

birds_beak_env <- birds %>% 
  dplyr:: select(2, 3, 25, 26, 28, 29)

summary(birds_beak)

# Convert to data.frame with rownames from Site column
birds_beak <- birds_beak %>% column_to_rownames("Species")

birds_beak_scaled <- scale(birds_beak)

# Set seed to make it reproducible
set.seed(123456789)


##### Perform PCA with all beak traits WITH Pelicans ***********

birds_beak_pca <- rda(birds_beak_scaled)

# Inspect by showing it in the console
birds_beak_pca

# Eigenvalues retrieval
eigenvals(birds_beak_pca)

# Retrieve eigenvalues PC axis and variance explained
summary(eigenvals(birds_beak_pca))
summary(birds_beak_pca)
# 4 PCs; PC 1 explains 85% of variation. 

# Create scree plot
screeplot(birds_beak_pca)

# With broken stick
screeplot(birds_beak_pca, bstick = TRUE)

# Create ordination diagram
ordiplot(birds_beak_pca, type = "text")

# Create ordination diagram with arrows for the beak dimensions (length two times, 
#depth and width)
biplot(birds_beak_pca, type = "text")
 
# Extract PC1 value for Univariate and GLM *********
# Extract PC1 and make object 

scorespca <- scores(birds_beak_pca)
scorespca$sites

# Extract PC1 and make object ******** IN PROGRESS
PC1 <- scorespca$sites[, 1] #????
PC1 <- as.data.frame(PC1)

PC1 %>% dplyr::select(1)

