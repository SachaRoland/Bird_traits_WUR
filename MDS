#### MDS for beak  WITHOUT pelicans------------------------------------------------------
  
#filter out independent variables
birds_env <- birds %>% 
  select(1, 2, 3, 25, 26, 27, 28, 29)

birds_beak_nopeli <- birds %>% 
  dplyr::filter(Order != "Pelecaniformes")

birds_beak_nopeli <- birds_beak_nopeli%>% 
  dplyr::select(1, 9, 10, 11, 12)

birds_beak_nopeli <- birds_beak_nopeli %>% column_to_rownames("Species")

birds_beak_nopeli_scaled <- scale(birds_beak_nopeli)

# Set seed to make it reproducible
set.seed(1234567)

#make an MDS --> the problem comes out of the k 
birds_nopeli_mds <- wcmdscale(vegdist(birds_beak_nopeli_scaled, method = "euclidean"), k = 2) # 2 ordinations axes 

birds_nopeli_mds_scores <- scores(birds_nopeli_mds, tidy = TRUE)

cor.test(birds_nopeli_mds_scores$Dim1, birds_nopeli_mds_scores$Dim2)

#calculate species scores
speciesScores <- wascores(birds_nopeli_mds, birds_nopeli)

ordiplot(birds_nopeli_mds, type = "points")

#text(speciesScores, labels = rownames(speciesScores), col = "red", cex = 0.6)
# Add convex-hulls for the different groups
ordihull(birds_nopeli_mds, groups = birds_env$Order,
         col = c("red","green", "blue", "purple", "orange", "yellow", "darkgreen", "darkred", "darkblue"),
         label = TRUE)
#extract centroids, calculate differences between those to have an idea between the differences
#separate MDS on seperate clusters might be interesting to get rid of the overlap
#if we want to do somethings statistical, we need to do a PCA
